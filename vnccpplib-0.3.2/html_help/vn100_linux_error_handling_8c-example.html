<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>VectorNav C/C++ Library: vn100_linux_error_handling.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">VectorNav C/C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">vn100_linux_error_handling.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>This examples illustrates the handling of errors received from a VN-100 sensor. Sometimes when using the device access functions, and error may be received from the sensor. These functions will return an error code indicating what type of error was received from the sensor. This is illustrated in the example below by the error code return from the function <a class="el" href="vn100_8h.html#a02ed08a26d518b2005310eac8ffa20d7">vn100_setAsynchronousDataOutputFrequency</a>. Other times, the VN-100 sensor may output an error code independent of any commands sent to it via the access functions. This may be caught by registering a <a class="el" href="vndevice_8h.html#a8500c2ae1a72fb38432cf182c2712175">VnDeviceErrorCodeReceivedListener</a> function which will receive this error code notifications</p>
<h1><a class="anchor" id="runningVn100LinuxErrorHandlingExample"></a>
Running the Example</h1>
<ol type="1">
<li>On your Linux machine, open a terminal and change to the directory <code>&lt;VectorNav C/C++ Library Root&gt;/examples/vn100_linux_error_handling</code>.</li>
<li>You will need to determine what port your sensor is connected to. Typically if you are connected to a physical COM port on your machine, this will typically be <code>/dev/ttyS1</code>. However, if you are connected using the USB cable, there will be a virtual COM port which will typically be identified as <code>/dev/ttyUSB0</code>. You can display which ports are available on the machine by executing the command <code>ls /dev</code>.</li>
<li>Open the file <code>vn100_linux_error_handling.c</code> in the current directory and at the top, change the global variable <code>COM_PORT</code> to the port identified in the previous step. You may also have to change the variable <code>BAUD_RATE</code> if this has been change on the sensor from the factory default.</li>
<li>First make sure there are not any binaries or object files by executing the command <code>make clean</code>.</li>
<li>Compile the example by executing <code>make</code>.</li>
<li>You can now run the example program by executing <code>./vn100_linux_error_handling</code>. Note on some distributions of Linux and depending on your system account privileges, you may have to sudo to run the program (i.e. <code>sudo ./vn100_linux_error_handling</code>).</li>
</ol>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="vectornav_8h.html">vectornav.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Change the connection settings to your configuration. */</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* PORT_NAME = <span class="stringliteral">&quot;//dev//ttyS1&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> BAUDRATE = 115200;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> errorCodeReceivedListener(<span class="keywordtype">void</span>* sender, <a class="code" href="vn__error_codes_8h.html#a2ab6e10832948454e3977ea34d483765">VN_ERROR_CODE</a> errorCode);</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <a name="_a0"></a><a class="code" href="struct_vn100.html" title="Holds connection information for accessing a VN-100 device. ">Vn100</a> vn100;</div>
<div class="line">    <span class="keywordtype">int</span> errorCode;</div>
<div class="line"></div>
<div class="line">    errorCode = <a name="a1"></a><a class="code" href="vn100_8h.html#ac67c964aedc127f46a5b3e61b2269f19" title="Connects to a VectorNav VN-100 device. ">vn100_connect</a>(&amp;vn100, PORT_NAME, BAUDRATE);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (errorCode != <a name="a2"></a><a class="code" href="group___v_n___e_r_r_o_r___c_o_d_e.html#ga375de3d5056cfee0551d6b345b67b3ff">VNERR_NO_ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error trying to connect to sensor.\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    errorCode = <a name="a3"></a><a class="code" href="vn100_8h.html#a88d78983bc3872c297c887b7b1cc7914" title="Allows registering a function which will be called whenever an error code is received from the VN-100...">vn100_registerErrorCodeReceivedListener</a>(</div>
<div class="line">        &amp;vn100,</div>
<div class="line">        &amp;errorCodeReceivedListener);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (errorCode != <a class="code" href="group___v_n___e_r_r_o_r___c_o_d_e.html#ga375de3d5056cfee0551d6b345b67b3ff">VNERR_NO_ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error attempting to register our errorCodeReceivedListener function.\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* We will try to set the asynchronous data output frequency to an invalid</span></div>
<div class="line"><span class="comment">     * value to demonstrate the error code system. */</span></div>
<div class="line">    errorCode = <a name="a4"></a><a class="code" href="vn100_8h.html#a02ed08a26d518b2005310eac8ffa20d7" title="Sets the values of the Asynchronous Data Output Frequency register. ">vn100_setAsynchronousDataOutputFrequency</a>(</div>
<div class="line">        &amp;vn100,</div>
<div class="line">        27,</div>
<div class="line">        <span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (errorCode == <a name="a5"></a><a class="code" href="group___v_n___e_r_r_o_r___c_o_d_e.html#gaea925f7e99aca9720ec5bc96a2decbae">VNERR_SENSOR_INVALID_PARAMETER</a>)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Received VNERR_SENSOR_INVALID_PARAMETER in main function.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errorCode != <a class="code" href="group___v_n___e_r_r_o_r___c_o_d_e.html#ga375de3d5056cfee0551d6b345b67b3ff">VNERR_NO_ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* This is not the error code the example expected to receive. */</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Received error code %u in main function.\n&quot;</span>, errorCode);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Did not receive an error as expected.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Sleep 1 second to make sure our errorCodeReceivedListener function gets the error code. */</span></div>
<div class="line">    sleep(1);</div>
<div class="line"></div>
<div class="line">    errorCode = <a name="a6"></a><a class="code" href="vn100_8h.html#a47024fdc81b53d0a3dc27b8961f5de67" title="Unregisters an already registered function for recieving notifications of when error codes from the V...">vn100_unregisterErrorCodeReceivedListener</a>(</div>
<div class="line">        &amp;vn100,</div>
<div class="line">        &amp;errorCodeReceivedListener);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (errorCode != <a class="code" href="group___v_n___e_r_r_o_r___c_o_d_e.html#ga375de3d5056cfee0551d6b345b67b3ff">VNERR_NO_ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Received error when trying to unregister our errorCodeReceivedListener function.\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    errorCode = <a name="a7"></a><a class="code" href="vn100_8h.html#ac5d243253fabebaa00ea8c8175e14b17" title="Disconnects from the VN-100 device and disposes of any internal resources. ">vn100_disconnect</a>(&amp;vn100);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (errorCode != <a class="code" href="group___v_n___e_r_r_o_r___c_o_d_e.html#ga375de3d5056cfee0551d6b345b67b3ff">VNERR_NO_ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Received error when trying to disconnect from the sensor.\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> errorCodeReceivedListener(<span class="keywordtype">void</span>* sender, <a class="code" href="vn__error_codes_8h.html#a2ab6e10832948454e3977ea34d483765">VN_ERROR_CODE</a> errorCode)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (errorCode == <a class="code" href="group___v_n___e_r_r_o_r___c_o_d_e.html#gaea925f7e99aca9720ec5bc96a2decbae">VNERR_SENSOR_INVALID_PARAMETER</a>)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Received VNERR_SENSOR_INVALID_PARAMETER in errorCodeReceivedListener function.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* This is not the error code the example expected to receive. */</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Received error code %u in errorCodeReceivedListener function.\n&quot;</span>, errorCode);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 11 2014 11:34:32 for VectorNav C/C++ Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
